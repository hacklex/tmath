(function the ultimate)

Основное понятие математики — функция. В школьной математике, они определялись правилами
вида

$$l(x) := 3x - 2$$

И вычислислялись с помощью подстановки:

$$\begin{aligned}
l(1) &= 3 - 2 = 1 \\
l(5) &= 15 - 2 = 13
\end{aligned}$$

Мы будем использовать определяемые выражением и вычисляемые с помощью подстановки функции
как основание математики. Но сначала понадобится запись для процесса вычисления выражения.

Запись ${?e_1} \leadsto {?e_2}$ означает, что результатом применения одного или более шагов
вычисления к ${?e_1}$ является выражение ${?e_2}$. Например, вот так вычисляется выражение $l(3)$:

$$l(3) \leadsto 3\cdot3 - 2 \leadsto 9 - 2 \leadsto 7$$

Первым шагом является подстановка $3$ в определение функции $l$, последующие же — арифметическими
операциями.

Эта нотация необходима, чтобы различить вычисление выражения и равенство. При этом равенство
мы рассматриваем как *высказывание[^prop],* которое может быть как истиным, так и ложным.

Например, $1=1$ это истинное высказывание, когда же $2=3$ — ложное высказывание.

Как и выражения, равенства тоже можно вычислять. Например:

$$(2\cdot 3 = 7-1) \leadsto (6 = 7-1) \leadsto (6=6)$$

Возможность обращаться с равенствами как с выражениями позволяет свести уравнения к функциям.
Например, пусть дано уравнение:

$$x^2 - 3x + 2 = 0$$

Ему соответствует функция, значением которой является высказывание:

$$eq(x) := (x^2 - 3x + 2 = 0)$$

Применяя $eq$ к различным значениям $x$, получаем различные высказывания. Некоторые из них
являются истиными:

$$eq(1) \leadsto (1 - 3 + 2 = 0) \leadsto (0 = 0) \\
eq(2) \leadsto (4 - 6 + 2 = 0) \leadsto (0 = 0)$$

Остальные — ложными:

$$\begin{aligned}
eq(0) &\leadsto (2 = 0) \\
eq(3) &\leadsto (9 - 9 + 2 = 0) \leadsto (2=0)
\end{aligned}$$

Значение $x$ является решением уравнения $eq$ в том случае, когда высказывание $eq(x)$ истино.

Тождества отличаются от уравнений тем, что они истины для всех возможных аргументов.
Например, возьмём коммутативность сложения:

$$comm(x,y) := (x+y = y+x)$$

Значение функции $comm$ истино для всех числовых значений $x$ и $y$.

Мы называли подстановку значений в выражения *вычислением,* хотя она не связана непосредственно
с числами. Это оправдано — с помощью функций можно выражать алгоритмы, в том числе арифметические
операции.

Проще всего это показать на примере сложения натуральных чисел. Пусть есть
два мешка — в левом лежат три камешка, когда же в правом — два. И пусть мы хотим
найти сумму этих камней:

$$\{\bullet{\bullet}\bullet\} + \{\bullet\bullet\}$$

Для этого мы перекладываем камешек из правого мешка в левый:

$$\{\bullet{\bullet}{\bullet}\bullet\} + \{\bullet\}$$

Затем перекладываем ещё один:

$$\{\bullet{\bullet}{\bullet}{\bullet}\bullet\} + \{\}$$

Когда правый мешок оказывается пуст, в левом лежит сумма всех камней — всего пять штук.

Чтобы записать этот алгоритм как функцию, нужно сначала выразить числа следующим образом:

$$0 = 0 \qquad 1 = s(0) \qquad 2 = s(s(0)) \qquad \dots$$

Мы можем сразу определить сложение числа с нулём:

$$n + 0 := n$$

Чтобы определить сложение с любым другим положительным числом, замечаем, что оно имеет вид $s(k)$,
где $k$ это число на единицу меньше. И определяем сложение как

$$n + s(k) := s(n) + k$$

Оба правила полностью определяют функцию $(+)$. В более традиционной форме это записывается
как

$$n + k := \begin{cases}
n &\text{если } k=0 \\
n+p &\text{если } k=s(p)
\end{cases}$$

Функция $(+)$ использует саму себя в своём определении. Такие функции называются *рекурсивными,*
а непосредственно ссылка функции на саму себя — рекурсией.

Вычислим $3+2$, используя данные выше определения:

$$\begin{aligned}
    s(s(s(0)))   + s(s(0)) &\leadsto  s(s(s(s(0))))  +   s(0) \\
  &\leadsto s(s(s(s(s(0))))) +     0 \\
  &\leadsto s(s(s(s(s(0)))))
\end{aligned}$$

Унарная система счисления это далеко не самое эффективное предствление чисел, а определённое
подобным образом сложение — не самый эффективный алгоритм. Но более оптимальный алгоритм тоже
можно выразить как функцию, только эта функция будет уже сложнее.

Некоторые конструкции в математике вводят новые переменные. Например, рассмотрим сумму
геометрической прогрессии:

$$\sum_{i=0}^n q^i = 1 + q + \dots + q^n$$

Запись суммы вводит новую переменную $i$, значения которой пробегают целые числа от нуля до $n$
включительно.

Таким конструкциям можно тоже сопоставить рекурсивную функции. Для суммы, это функцию
можно определить так:

$$sum(l, u, f) := ite \big(l\leqslant u,\ sum(l, u-1, f) + f(u),\ 0 \big)$$

Агрумент $f$ здесь также является функцией. $ite$ же это функция определённая следующим образом:

$$ite(p, a, b) := \begin{cases}
a &\text{если } p \text{ истино} \\
b &\text{если } p \text{ ложно}
\end{cases}$$

Рассмотрим на примере. Пусть мы хотим найти сумму квадратов чисел от одного до трёх. Для этого
мы определяем функцию

$$sq(x) := x^2$$

И затем вычисляем:

$$\begin{aligned}
sum(1, 3, sq) &\leadsto sum(1, 2, sq) + sq(3) \\
 &\leadsto sum(1, 1, sq) + sq(2) + sq(3) \\
 &\leadsto sum(1, 0, sq) + sq(1) + sq(2) + sq(3) \\
 &\leadsto 0 + 1 + 4 + 9 \\
 &\leadsto 14
\end{aligned}$$

Чтобы не давать имена функциям вроде $sq$, введём понятие анонимной функции. Анонимная функция
записывается как $λ\, {?v}.\; ?e$, где $?v$ это переменная, а $?e$ — выражение.

Например, анонимная функция, вычисляющая квадрат числа выглядит следующим образом:
$λx.\; x^2$. Применяется же анонимные функции точно также, как и обычные функции:

$$(λx.\; x^2)(3) \leadsto 3^2 \leadsto 9$$

С помощью анонимной функции, сумма геометрической прогрессии может быть записана как
$sum(0, n, λi.\; q^i)$.

Как и любые выражения, анонимная функция тоже может быть результатом какой-то другой функции.
Например, определим

$$mul(x) := λy.\; x\cdot y$$

Тогда применение этой функции к $2$, а затем применение результата к $3$ вычисляется следующим
образом:

$$mul(2)(3) \leadsto (λy.\; 2\cdot y)(3) \leadsto 2\cdot 3 \leadsto 6$$

Этот пример также показывает, что функция двух аргументов могут быть сведенена к
функции одного аргумента, результатом которой также является функция. Такое преобразование
называется *каррированием*.

Мы показали, как различные математические понятия и конструкции могут быть сведенены к функциям. Позже мы увидим, что даже математические доказательства могут быть выраженны как функции.

Но перед этим мы должны ввести формальную систему, называющуюся лямбда-исчислением.

[^prop]: Замечание для программистов: высказывание != булево значение.