Это книга про то, как выражать математику с помощью формального языка. Но сначала нам потребуется описать сам язык. При этом важно различать выражения языка, от выражений, *описывающих* язык (метавыражений).

Языком описания (метаязыком) является смесь естественного языка и нотации. При этом важнейшей частью нотации являются *метапеременные*, позволяющие абстрагировать выражения описываемого языка.

Рассмотрим пример -- пусть мы описываем предложения на английском языке, используя русский язык с метапеременными в качестве метаязыка. Рассмотрим следующую фразу:

```
Hello world.
```

Абстрагируем слово "world", введя метапеременную `?сл`:

```
Hello ?сл.
```

Если мы подставим "all" на место `?сл`, то получим:

```
Hello all.
```

Или же мы можем подставить "there", чтобы получить:

```
Hello there.
```

В математических выражениях, метапеременные могут соседствовать с переменными описываемого языка. Например, в следующем выражении `x` это переменная языка, когда же `?e` это метапеременная:

$$x = {?e}$$

Кроме того, мы можем подставлять выражения, содержащие переменные. Например, можно подставить $3+y$ на мест ${?e}$:

$$x = 3 + y$$

Здесь важно уточнить, какую именно подстановку мы имеем в виду. Можно рассматривать выражения как последовательность символов, и подставлять их в переменные как строки. Тогда подстановка $y + 3⋅z$ в выражение $2 \cdot {?e}$ даёт

$$2 \cdot y + 3 \cdot z$$

Такую подстановку мы использовать *не будем*. Вместо этого мы рассматриваем выражения как синтаксические деревья, с учётом приоритетов операций:

TODO: релевантная картинка
![](https://ruslanspivak.com/lsbasi-part7/lsbasi_part7_astprecedence_01.png)

При подстановке, мы заменяем листья с метапеременной на дерево подставляемого выражения. При этом в результате могут появляся скобки:

$$2 \cdot (y + 3 \cdot z)$$

Круглые скобки являются частью строки, представляющей выражение, но не являются частью абстрактного синтаксического дерева.

Перед тем, как говорить о выражениях, нужно, однако, описать грамматику языка. Опишем грамматику простого языка арифметических выражений с переменными, сложением и умножением.

Всякое подобное корректное выражение является чем-то из следующего:

- Числом
- Имя переменной
- Сложением ${?e_1}+{?e_2}$, где $?e_1$ и $?e_2$ это корректные выражения
- Умножением ${?e_1} \cdot {?e_2}$, где $?e_1$ и $?e_2$ это корректные выражения

Покажем, что $2 \cdot (y + 3 \cdot z)$ соответствует этому описанию:

1. Само выражение соответствует варианту ${?e_1} \cdot {?e_2}$, где ${?e_1}$ это $2$ и ${?e_2}$ это $y + 3 \cdot z$
    1. $?e_1$ это грамматически корректное выражение, так как $2$ это число
    2. $y + 3 \cdot z$ соответствует варианту ${?e_3} + {?e_4}$, где ${?e_3}$ это $y$ и $?e_4$ это $3 \cdot z$
        1. ${?e_3}$ это грамматически корректное выражение, потому что $y$ это имя переменной
        2. И $3 \cdot z$, очевидно, также является грамматически корректным выражением

Мы будем записывать грамматики символьно. Для арифметических выражений она записывается так:

$$\begin{aligned}
expr ::= \ &num & & & \text{(число)} \\
\mid\quad &var & & & \text{(имя переменной)} \\
\mid\quad  &“{?e_1}+{?e_2}” & e_1\ e_2 &: expr &  \text{(сложение)}\\
\mid\quad &“{?e_1} \cdot {?e_2}” & e_1\ e_2 &: expr & \text{(умножение)}
\end{aligned}$$

Мы разделяем варианты вертикальной чертой и оборачиваем выражения определяемого языка в кавычки. 

Эту же грамматику можно записать и другим, более традиционным способом:

$$\begin{aligned}
expr ::= \ &num & &\text{(число)} \\
\mid\quad &var & &\text{(имя переменной)} \\
\mid\quad &expr\ \mathbin{“{+}”}\ expr & &\text{(сложение)} \\
\mid\quad &expr\ \mathbin{“\cdot”}\ expr & &\text{(умножение)}
\end{aligned}$$

Здесь запись $expr\ “{+}”\ expr$ означает, что после выражения идет символ $+$, а затем идет другое выражение, которое может не совпадать с предыдущим.

Грамматика не описывает приоритеты операций, и мы будем их оговаривать отдельно.
